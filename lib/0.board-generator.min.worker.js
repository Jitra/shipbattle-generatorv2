/*! board-generator - 1.0.41 */!function(r){var t={};function e(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return r[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}e.m=r,e.c=t,e.d=function(r,t,n){e.o(r,t)||Object.defineProperty(r,t,{enumerable:!0,get:n})},e.r=function(r){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},e.t=function(r,t){if(1&t&&(r=e(r)),8&t)return r;if(4&t&&"object"==typeof r&&r&&r.__esModule)return r;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:r}),2&t&&"string"!=typeof r)for(var o in r)e.d(n,o,function(t){return r[t]}.bind(null,o));return n},e.n=function(r){var t=r&&r.__esModule?function(){return r.default}:function(){return r};return e.d(t,"a",t),t},e.o=function(r,t){return Object.prototype.hasOwnProperty.call(r,t)},e.p="/lib",e(e.s=0)}([function(r,t,e){"use strict";var n=e(1);onmessage=function(r){var t,e=r.data,o=e.type,i=e.msgId,a=e.payload,u=a.ships,c=a.width,s=a.height,f={},l=new n.BoardService;try{switch(o){case"CREATE_MAP":f.board=l.initMap(c,s),l.addShips(u,f.board)}}catch(r){t=r.toString()}self.postMessage({msgId:i,errors:t,payload:f})}},function(r,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uuidv4=a,t.BoardService=void 0;var n=e(2);function o(r){return function(r){if(Array.isArray(r)){for(var t=0,e=new Array(r.length);t<r.length;t++)e[t]=r[t];return e}}(r)||function(r){if(Symbol.iterator in Object(r)||"[object Arguments]"===Object.prototype.toString.call(r))return Array.from(r)}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var i=99;function a(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var t=16*Math.random()|0;return("x"===r?t:3&t|8).toString(16)})}var u=function(){return function(){function r(r,t){var e=t.fields.filter(function(r){return!r.ship&&!r.marked});if(e.length<r)throw new Error("Not enough empty fields");var n=e[Math.floor(Math.random()*(e.length-1))];return n.marked=!0,n}function t(r,t,e){var n=e.fields.findIndex(function(t){return t.x===r.x&&t.y===r.y}),o=n+t;if(n%e.cols+t>e.cols-1||o>=e.cols*e.rows)throw new Error("Out of boundary start: ".concat(n," end: ").concat(o));var i=(o+1)%e.cols;if(i>0)return{start:n,end:o+1};if(0===i)return{start:n,end:o};throw new Error("Out of boundary")}function e(r){return r.filter(function(r){return r.ship}).length>0}function u(n,o){var i=r(n,o);do{for(var a=0;a<4;a++)try{var u=t(i,n,o),c=u.start-o.cols,s=u.start+o.cols,f=-1!==c?o.fields.slice(c,u.end-o.cols+1):[],l=-1!==s?o.fields.slice(s,u.end+o.cols+1):[],d=o.fields.slice(u.start,u.end+1);if(e(d)||e(f)||e(l))throw new Error("Occupied field");return d.splice(0,1),(u.start+n+1)%o.cols>0&&d.splice(-1,1),d}catch(r){o.rotate90Degree()}i=r(n,o)}while(i)}this.addShips=function(r,t){var e=r.sort(function(r,t){return r.shipLength-t.shipLength}),n=[],c=0;do{try{for(var s=function(e){var i=[];(i=u(r[e].shipLength,t)).forEach(function(t){return t.ship={...r[e],id:a()}}),n.push.apply(n,o(i))},f=e.length-1;f>0;f--)s(f);break}catch(r){c++,n.forEach(function(r){delete r.ship,delete r.marked})}}while(c<i);if(c===i)throw new Error("Exceeded ".concat(i," tries"));t.fields.forEach(function(r){return delete r.marked})},this.initMap=function(r,t){for(var e=[],o=0;o<t;o++)for(var i=0;i<r;i++)e.push({hit:!1,x:i,y:o});return new n.Matrix(r,t,e)}}}();t.BoardService=u},function(r,t,e){"use strict";function n(r){return function(r){if(Array.isArray(r)){for(var t=0,e=new Array(r.length);t<r.length;t++)e[t]=r[t];return e}}(r)||function(r){if(Symbol.iterator in Object(r)||"[object Arguments]"===Object.prototype.toString.call(r))return Array.from(r)}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.Matrix=void 0;var i=function(){function r(t,e,n){!function(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r);var o=t*e;if(o!==n.length)throw new Error("\n      Cannot create matrix of inconsistend fields amount: ".concat(n.length,"\n      number of fields should equal cols * rows = ").concat(o,"\n      "));this.cols=t,this.rows=e,this.fields=n}var t,e,i;return t=r,(e=[{key:"getIndex",value:function(r,t){return r>this.cols||r<0||t>this.rows||t<0?-1:t*this.cols+r}},{key:"getRow",value:function(r){return this.fields.slice(this.getIndex(0,r),this.cols-1)}},{key:"getColumn",value:function(r){for(var t=[],e=0;e<this.cols;e++){var n=this.getIndex(r,e);t.push(this.fields[n])}return t}},{key:"rotate90Degree",value:function(){for(var r=[],t=0;t<this.cols;t++)r.push.apply(r,n(this.getColumn(t).reverse()));this.fields=r}}])&&o(t.prototype,e),i&&o(t,i),r}();t.Matrix=i}]);